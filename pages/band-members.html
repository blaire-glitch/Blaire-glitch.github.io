<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Band Members | Arise Band_KE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../styles/styles.css" />
  <link rel="stylesheet" href="../styles/pages.css" />
  <link rel="stylesheet" href="../styles/loader.css" />
  
  <!-- URL Handler - Remove .html from URL bar -->
  <script src="../scripts/url-handler.js"></script>
  
  <!-- Google Sign-In -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com">
</head>
<body>
  <!-- Page Loader -->
  <div class="page-loader">
    <div class="loader-content">
      <img src="../assets/images/logo.jpg" alt="Arise Band_KE" class="loader-logo">
      <div class="loader-text">ARISE BAND_KE</div>
      <div class="loader-spinner"></div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand" href="../index.html">
        <img src="../assets/images/logo.jpg" alt="Arise Band_KE Logo" class="navbar-logo">
        <span class="ms-2">Arise Band_KE</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="../index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="band-members.html">Band Members</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="events.html">Events</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="gallery.html">Gallery</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="fanwall.html">Fan Wall</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../index.html#contact">Contact</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="py-5 bg-light">
    <div class="container">
      <div class="d-flex justify-content-between align-items-center mb-5">
        <h2 class="mb-0">Meet the Band</h2>
        <button class="btn btn-info" data-bs-toggle="modal" data-bs-target="#memberLoginModal">
          <i class="bi bi-person-circle me-2"></i>Band Member Login
        </button>
      </div>
      <div class="row g-4 justify-content-center">
        <div class="col-md-3 text-center">
          <a href="member-irene.html">
            <div class="member-card">
              <img src="../assets/images/member1.jpg" alt="Irene Merab" class="member-photo mb-3">
              <h5>Irene Merab</h5>
              <p class="text-muted mb-0">Vocalist</p>
            </div>
          </a>
        </div>
        <div class="col-md-3 text-center">
          <a href="member-tracy.html">
            <div class="member-card">
              <img src="../assets/images/member2.jpg" alt="Sam Tracy" class="member-photo mb-3">
              <h5>Sam Tracy</h5>
              <p class="text-muted mb-0">Vocalist</p>
            </div>
          </a>
        </div>
        <div class="col-md-3 text-center">
          <a href="member-Becky.html">
            <div class="member-card">
              <img src="../assets/images/member3.jpg" alt="Becky Ogoye" class="member-photo mb-3">
              <h5>Becky Ogoye</h5>
              <p class="text-muted mb-0">Vocalist</p>
            </div>
          </a>
        </div>
        <!-- Add more members as needed -->
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-dark text-white py-5">
    <div class="container">
      <!-- Quick Links Section -->
      <div class="row mb-4">
        <div class="col-md-3 col-sm-6 mb-3">
          <h5 class="text-info mb-3">Quick Links</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="../index.html#about" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> About Us</a></li>
            <li class="mb-2"><a href="../index.html#events" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Events</a></li>
            <li class="mb-2"><a href="band-members.html" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Band Members</a></li>
            <li class="mb-2"><a href="gallery.html" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Gallery</a></li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
          <h5 class="text-info mb-3">Connect</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="fanwall.html" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Fan Wall</a></li>
            <li class="mb-2"><a href="../index.html#contact" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Contact Us</a></li>
            <li class="mb-2"><a href="social-feed.html" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Social Feed</a></li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
          <h5 class="text-info mb-3">Resources</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="../index.html#media" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Media</a></li>
            <li class="mb-2"><a href="events.html" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> All Events</a></li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-6 mb-3">
          <h5 class="text-info mb-3">Support Us</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="#" data-bs-toggle="modal" data-bs-target="#mpesaModal" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Donate via M-Pesa</a></li>
            <li class="mb-2"><a href="mailto:arisebandkenya@gmail.com" class="text-white-50 text-decoration-none hover-link"><i class="bi bi-chevron-right"></i> Email Us</a></li>
          </ul>
        </div>
      </div>

      <!-- Social Media & Copyright -->
      <div class="row">
        <div class="col-12 text-center pt-3 border-top border-secondary">
          <div class="mb-3">
            <a href="https://instagram.com" class="text-white me-3 fs-4"><i class="fab fa-instagram"></i></a>
            <a href="https://youtube.com" class="text-white me-3 fs-4"><i class="fab fa-youtube"></i></a>
            <a href="https://facebook.com" class="text-white me-3 fs-4"><i class="fab fa-facebook"></i></a>
            <a href="https://tiktok.com" class="text-white fs-4"><i class="fab fa-tiktok"></i></a>
          </div>
          <p class="mb-0 text-white-50">&copy; 2025 Arise Band_KE. All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Support Us Modal -->
  <div class="modal fade" id="supportModal" tabindex="-1" aria-labelledby="supportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content bg-dark text-white border-info">
        <div class="modal-header border-info">
          <h5 class="modal-title" id="supportModalLabel">
            <i class="bi bi-heart-fill text-danger me-2"></i>Support Arise Band
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-4">
            <p class="lead">Your support helps us spread worship and reach more communities</p>
          </div>
          
          <div class="row g-3">
            <div class="col-md-6">
              <div class="card bg-secondary border-info h-100 text-center p-3">
                <i class="bi bi-phone-fill text-success fs-1"></i>
                <h6 class="mt-3 text-white">M-Pesa</h6>
                <p class="small text-white-50 mb-3">Quick mobile payment</p>
                <button class="btn btn-success btn-sm" onclick="location.href='online-payments.html'">
                  Pay Now
                </button>
              </div>
            </div>
            
            <div class="col-md-6">
              <div class="card bg-secondary border-info h-100 text-center p-3">
                <i class="bi bi-credit-card text-warning fs-1"></i>
                <h6 class="mt-3 text-white">Other Methods</h6>
                <p class="small text-white-50 mb-3">Card, PayPal, Bank Transfer</p>
                <a href="online-payments.html" class="btn btn-warning btn-sm text-dark">
                  View Options
                </a>
              </div>
            </div>
          </div>
          
          <div class="alert alert-info mt-4 mb-0">
            <i class="bi bi-info-circle-fill me-2"></i>
            <strong>Every contribution matters!</strong> Your giving supports worship events, equipment, and community outreach.
          </div>
        </div>
        <div class="modal-footer border-info">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Band Member Login Modal -->
  <div class="modal fade" id="memberLoginModal" tabindex="-1" aria-labelledby="memberLoginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark border-info">
        <div class="modal-header border-info">
          <h5 class="modal-title text-info" id="memberLoginModalLabel">
            <i class="bi bi-person-circle me-2"></i>Band Member Access
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Login/Signup Tabs -->
          <ul class="nav nav-pills mb-4 justify-content-center" id="memberAuthTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="login-tab" data-bs-toggle="pill" data-bs-target="#login-panel" type="button" role="tab" aria-controls="login-panel" aria-selected="true">
                <i class="bi bi-box-arrow-in-right me-1"></i>Login
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="signup-tab" data-bs-toggle="pill" data-bs-target="#signup-panel" type="button" role="tab" aria-controls="signup-panel" aria-selected="false">
                <i class="bi bi-person-plus me-1"></i>Sign Up
              </button>
            </li>
          </ul>

          <div class="tab-content" id="memberAuthTabsContent">
            <!-- Login Panel -->
            <div class="tab-pane fade show active" id="login-panel" role="tabpanel" aria-labelledby="login-tab">
              <form id="memberLoginForm">
                <div class="mb-3">
                  <label for="loginEmail" class="form-label text-white">Email Address</label>
                  <input type="email" class="form-control bg-secondary text-white border-info" id="loginEmail" placeholder="your.email@arise.com" required>
                </div>
                <div class="mb-3">
                  <label for="loginPassword" class="form-label text-white">Password</label>
                  <input type="password" class="form-control bg-secondary text-white border-info" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <div class="mb-3 form-check">
                  <input type="checkbox" class="form-check-input border-info" id="rememberMe">
                  <label class="form-check-label text-white-50 small" for="rememberMe">
                    Remember me
                  </label>
                </div>
                <button type="submit" class="btn btn-info w-100 mb-3">
                  <i class="bi bi-box-arrow-in-right me-2"></i>Login
                </button>
                
                <!-- Divider -->
                <div class="position-relative mb-3">
                  <hr class="text-white-50">
                  <span class="position-absolute top-50 start-50 translate-middle px-3 text-white-50 small" style="background-color: #212529;">OR</span>
                </div>
                
                <!-- Google Sign-In Button -->
                <div id="g_id_onload"
                     data-client_id="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com"
                     data-callback="handleGoogleSignIn"
                     data-auto_prompt="false">
                </div>
                <div class="g_id_signin"
                     data-type="standard"
                     data-size="large"
                     data-theme="filled_blue"
                     data-text="sign_in_with"
                     data-shape="rectangular"
                     data-logo_alignment="left"
                     data-width="100%">
                </div>
                
                <div class="text-center mt-3">
                  <a href="#" class="text-info small text-decoration-none">Forgot Password?</a>
                </div>
              </form>
            </div>

            <!-- Sign Up Panel -->
            <div class="tab-pane fade" id="signup-panel" role="tabpanel" aria-labelledby="signup-tab">
              <form id="memberSignupForm">
                <div class="mb-3">
                  <label for="signupName" class="form-label text-white">Full Name</label>
                  <input type="text" class="form-control bg-secondary text-white border-info" id="signupName" placeholder="Your Full Name" required>
                </div>
                <div class="mb-3">
                  <label for="signupEmail" class="form-label text-white">Email Address</label>
                  <input type="email" class="form-control bg-secondary text-white border-info" id="signupEmail" placeholder="your.email@arise.com" required>
                </div>
                <div class="mb-3">
                  <label for="signupPhone" class="form-label text-white">Phone Number</label>
                  <input type="tel" class="form-control bg-secondary text-white border-info" id="signupPhone" placeholder="254722104985" required>
                </div>
                <div class="mb-3">
                  <label for="signupPassword" class="form-label text-white">Password</label>
                  <input type="password" class="form-control bg-secondary text-white border-info" id="signupPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <div class="mb-3">
                  <label for="signupConfirmPassword" class="form-label text-white">Confirm Password</label>
                  <input type="password" class="form-control bg-secondary text-white border-info" id="signupConfirmPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <div class="mb-3">
                  <label for="signupRole" class="form-label text-white">Role in Band</label>
                  <select class="form-select bg-secondary text-white border-info" id="signupRole" required>
                    <option value="">Select your role...</option>
                    <option value="vocalist">Vocalist</option>
                    <option value="guitarist">Guitarist</option>
                    <option value="bassist">Bassist</option>
                    <option value="drummer">Drummer</option>
                    <option value="keyboardist">Keyboardist</option>
                    <option value="manager">Manager</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <button type="submit" class="btn btn-warning w-100">
                  <i class="bi bi-person-plus me-2"></i>Create Account
                </button>
              </form>
            </div>
          </div>

          <div class="alert alert-warning mt-4 mb-0">
            <i class="bi bi-shield-lock-fill me-2"></i>
            <strong>For Band Members Only:</strong> This area is restricted to official Arise Band members. Contact management for access approval.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../scripts/main.js"></script>
  <script>
    // Google Sign-In Handler
    function handleGoogleSignIn(response) {
      try {
        // Decode JWT token to get user info
        const userData = parseJwt(response.credential);
        
        console.log('Google Sign-In successful:', userData);
        
        // Check if the Google account matches any registered band member
        const member = bandMembers.find(m => 
          m.email.toLowerCase() === userData.email.toLowerCase()
        );
        
        if (member) {
          // Authorized band member
          const loginData = {
            name: member.name,
            email: member.email,
            role: member.role,
            privileges: member.privileges,
            timestamp: new Date().toISOString(),
            rememberMe: true,
            googleAuth: true,
            picture: userData.picture
          };
          
          localStorage.setItem('ariseBandMemberLogin', JSON.stringify(loginData));
          
          alert(`‚úÖ Welcome back, ${member.name}! (${member.role})\nSigned in with Google\nRedirecting to your dashboard...`);
          window.location.href = 'member-dashboard.html';
        } else {
          // Not an authorized band member
          alert(`‚ùå Access Denied\n\nThe Google account "${userData.email}" is not registered as a band member.\n\nPlease use an authorized band member email or contact management for access.`);
        }
      } catch (error) {
        console.error('Google Sign-In error:', error);
        alert('‚ùå Google Sign-In failed. Please try again or use email/password login.');
      }
    }
    
    // Helper function to decode JWT token
    function parseJwt(token) {
      try {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
        return JSON.parse(jsonPayload);
      } catch (e) {
        console.error('Error parsing JWT:', e);
        return null;
      }
    }

    // Band Member Database with Roles and Privileges
    const bandMembers = [
      {
        name: 'Sam Tracy',
        email: 'sam.tracy@ariseband.com',
        password: 'musicdirector2025',
        role: 'Music Director',
        privileges: {
          canManageRehearsals: true,
          canEditSongs: true,
          canManageMembers: true,
          canAccessStudio: true,
          canViewAnalytics: true,
          canScheduleEvents: true,
          canApproveRecordings: true,
          accessLevel: 'admin'
        }
      },
      {
        name: 'Irene Merab',
        email: 'irene.merab@ariseband.com',
        password: 'leadvocalist2025',
        role: 'Lead Vocalist',
        privileges: {
          canManageRehearsals: false,
          canEditSongs: true,
          canManageMembers: false,
          canAccessStudio: true,
          canViewAnalytics: true,
          canScheduleEvents: false,
          canApproveRecordings: false,
          accessLevel: 'lead'
        }
      },
      {
        name: 'Becky',
        email: 'becky@ariseband.com',
        password: 'vocalist2025',
        role: 'Vocalist',
        privileges: {
          canManageRehearsals: false,
          canEditSongs: false,
          canManageMembers: false,
          canAccessStudio: true,
          canViewAnalytics: false,
          canScheduleEvents: false,
          canApproveRecordings: false,
          accessLevel: 'member'
        }
      }
    ];

    // Band Member Login Handler
    document.getElementById('memberLoginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value;
      const rememberMe = document.getElementById('rememberMe').checked;
      
      // Find member in database
      const member = bandMembers.find(m => m.email.toLowerCase() === email.toLowerCase());
      
      if (!member) {
        alert('‚ùå Invalid email address. Please contact band management if you need access.');
        return;
      }
      
      if (member.password !== password) {
        alert('‚ùå Incorrect password. Please try again or contact band management.');
        return;
      }
      
      // Successful login - store member data with role and privileges
      const loginData = {
        name: member.name,
        email: member.email,
        role: member.role,
        privileges: member.privileges,
        timestamp: new Date().toISOString(),
        rememberMe: rememberMe
      };
      
      // Store in localStorage
      localStorage.setItem('ariseBandMemberLogin', JSON.stringify(loginData));
      
      // Show personalized success message
      alert(`‚úÖ Welcome back, ${member.name}! (${member.role})\nRedirecting to your dashboard...`);
      
      // Redirect to dashboard
      window.location.href = 'member-dashboard.html';
    });

    // Band Member Signup Handler
    document.getElementById('memberSignupForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const phone = document.getElementById('signupPhone').value;
      const password = document.getElementById('signupPassword').value;
      const confirmPassword = document.getElementById('signupConfirmPassword').value;
      const role = document.getElementById('signupRole').value;
      
      // Validate passwords match
      if (password !== confirmPassword) {
        alert('Passwords do not match. Please try again.');
        return;
      }
      
      // Validate password strength (minimum 8 characters)
      if (password.length < 8) {
        alert('Password must be at least 8 characters long.');
        return;
      }
      
      // Create signup request
      const signupData = {
        name: name,
        email: email,
        phone: phone,
        role: role,
        timestamp: new Date().toISOString()
      };
      
      // Send notification via WhatsApp (to band management)
      const whatsappNumber = '254722104985';
      const message = `üéµ NEW BAND MEMBER SIGNUP REQUEST üéµ\n\n` +
                     `Name: ${name}\n` +
                     `Email: ${email}\n` +
                     `Phone: ${phone}\n` +
                     `Role: ${role}\n\n` +
                     `Please review and approve this signup request.\n` +
                     `Time: ${new Date().toLocaleString()}`;
      
      const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
      
      // Store signup request
      localStorage.setItem('ariseBandMemberSignupRequest', JSON.stringify(signupData));
      
      // Show success message
      alert('Signup request submitted! Band management will review your application. You will be contacted via email or phone.');
      
      // Open WhatsApp notification (optional - for immediate notification)
      if (confirm('Would you like to send a direct notification to band management via WhatsApp?')) {
        window.open(whatsappUrl, '_blank');
      }
      
      // Close modal
      const modal = bootstrap.Modal.getInstance(document.getElementById('memberLoginModal'));
      modal.hide();
      
      // Reset form
      this.reset();
    });

    // Clear forms when modal is closed
    document.getElementById('memberLoginModal').addEventListener('hidden.bs.modal', function () {
      document.getElementById('memberLoginForm').reset();
      document.getElementById('memberSignupForm').reset();
    });
  </script>
</body>
</html>