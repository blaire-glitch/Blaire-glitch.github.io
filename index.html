<!DOCTYPE html>
<!-- Mobile friendly: ensure the <head> includes
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  and consider adding <meta name="theme-color" content="#000000"> for better mobile theming. -->
<html lang="en" class="h-100" data-bs-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arise Band_Ke</title>
  <link rel="icon" href="assets/images/logo.jpg" type="image/jpeg" sizes="32x32">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  
  <!-- Custom CSS (Modular) -->
  <link rel="stylesheet" href="styles/styles.css" />
  <link rel="stylesheet" href="styles/components.css" />
  <link rel="stylesheet" href="styles/sections.css" />
  <link rel="stylesheet" href="styles/animations.css" />
  <link rel="stylesheet" href="styles/responsive.css" />
  <link rel="stylesheet" href="styles/loader.css" />
  
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>

<body>
  <!-- Page Loader -->
  <div class="page-loader">
    <div class="loader-content">
      <img src="assets/images/logo.jpg" alt="Arise Band_KE" class="loader-logo">
      <div class="loader-text">ARISE BAND_KE</div>
      <div class="loader-spinner"></div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="assets/images/logo.jpg" alt="Arise Band_KE Logo" class="navbar-logo">
        <span class="ms-2">Arise Band_KE</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link active" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pages/band-members.html">Band Members</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pages/events.html">Events</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pages/gallery.html">Gallery</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pages/fanwall.html">Fan Wall</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#contact">Contact</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="bg-dark text-white text-center py-5">
    <div class="container d-flex flex-column flex-md-row align-items-center justify-content-center gap-4">
      <!-- Floating Slideshow Rectangle -->
      <div class="carousel-container bg-white rounded-4 shadow-lg overflow-hidden mb-4 mb-md-0">
        <div id="heroCarousel" class="carousel slide h-100" data-bs-ride="carousel">
          <div class="carousel-inner h-100">
            <div class="carousel-item active h-100">
              <img src="assets/images/slide1.jpg" class="d-block w-100 h-100 object-fit-cover" alt="Band performing">
            </div>
            <div class="carousel-item h-100">
              <img src="assets/images/slide2.jpg" class="d-block w-100 h-100 object-fit-cover" alt="Band worship">
            </div>
            <div class="carousel-item h-100">
              <img src="assets/images/slide3.jpg" class="d-block w-100 h-100 object-fit-cover" alt="Band event">
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
      <!-- Hero Text -->
      <div class="flex-grow-1">
        <h1 class="display-4">Welcome to Arise Band_KE</h1>
        <p class="lead">Gospel. Groove. Glory.</p>
        <a href="pages/events.html" class="btn btn-primary btn-lg mt-3">Explore Events</a>
      </div>
    </div>
  </header>

  <!-- About Section -->
  <section id="about" class="py-5 bg-light">

  </section>
  <div class="container">
    <h2 class="text-center mb-4">About Us</h2>
    <p class="text-center">Arise Band_KE is a vibrant gospel band from Kenya, blending soulful harmonies with powerful
      messages. We perform live, record original music, and inspire through sound. Our mission is rooted in Isaiah 60:1,
      "Arise, shine, for your light has come, and the glory of the Lord rises upon you."</p>
  <p>Founded with a passion for worship and community outreach, Arise Band_Kenya has grown into a vibrant ministry impacting lives through music, prayer, and service. From humble beginnings to powerful concerts and outreach missions, our journey is one of faith, unity, and purpose.</p></div>
  </section>

  <!-- Vision & Mission Section -->
  <section id="vision-mission" class="py-5 text-white">
    <div class="container">
      <div class="container text-center mb-5">
        <h2 id="vmHeading" class="animate__animated color-transition">Vision & Mission</h2>
      </div>

      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="card bg-transparent border-0 rounded h-100 animate__animated">
            <div class="vision-mission-card">
              <img src="assets/images/vision.jpg" alt="Vision - Arise Band in worship" class="card-cover">
              <div class="card-overlay">
                <div class="card-body">
                  <h3 class="card-title text-info">Vision</h3>
                  <p class="card-text">To be a beacon of light in Busia County and beyond, spreading the gospel of Jesus Christ through music, worship, and ministry, while fostering spiritual growth, unity, and transformation in the community.</p>
                </div>
              </div>
            </div>
          </div>

          </div>

          <div class="col-md-6 mb-4">
            <div class="card bg-transparent border-0 rounded h-100 animate__animated">
              <div class="vision-mission-card">
                <img src="assets/images/mission.jpg" alt="Mission - Arise Band ministry" class="card-cover">
                <div class="card-overlay">
                  <div class="card-body">
                    <h3 class="card-title text-warning">Mission</h3>
                    <p class="card-text">To create an atmosphere of worship and praise that elevates the name of Jesus Christ, empowers believers, and attracts the lost through contemporary gospel music rooted in biblical truth, God's love, and the leading of the Holy Spirit.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>

      <!-- Dismissible Alert -->
      <div
        class="alert alert-info alert-dismissible fade show mt-5 text-center shadow-sm rounded animate__animated animate__slideInRight notification-alert"
        role="alert">
        üôå Join us in spreading joy and faith through music and worship ‚Äî every soul matters!
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    </div>
  </section>

<section>
  <div class="container my-5">
    <h2 class="text-center mb-4">
      <img src="assets/images/logo.jpg" alt="Arise Band Logo" class="ministry-logo">
      Ministry in Action
    </h2></h2>
    <div class="row justify-content-center">
      <div class="col-md-4 mb-3">
        <div class="card h-100 shadow-sm">
          <img src="assets/images/concert.jpg" class="card-img-top" alt="Worship Concert">
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100 shadow-sm">
          <img src="assets/images/outreach.jpg" class="card-img-top" alt="Community Outreach">
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100 shadow-sm">
          <img src="assets/images/rehearsal.jpg" class="card-img-top" alt="Band Rehearsal">
        </div>
      </div>
    </div>
  </div>
</section>
  <!-- Media Section -->
  <section id="media" class="py-5">
    <div class="container">
      <h2 class="text-center mb-4">Watch & Listen</h2>
      <div class="row justify-content-center">
        <div class="col-12">
          <div class="container px-0"></div>
            <div class="row g-3 justify-content-center align-items-start">
              <div class="col-6 col-sm-4 col-md-3">
                <div class="card bg-dark border-0 shadow-sm">
                  <div class="ratio ratio-16x9">
                    <iframe src="https://www.youtube.com/embed/nlGtsI6zp00" title="Arise Band Video" frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                  </div>
                </div>
              </div>

              <div class="col-6 col-sm-4 col-md-3">
                <div class="card bg-dark border-0 shadow-sm">
                  <div class="ratio ratio-16x9">
                    <div class="ratio ratio-16x9 mb-2"><iframe width="853" height="480" src="https://www.youtube.com/embed/AX8Ugl3VmEo" title="Showers of blessings cover" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                   
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div> <!-- Social Feed Placeholder -->
    <!-- Update the social feed section with an id -->

  </section>

  <!-- Events Section -->
  <section id="events" class="py-5 bg-light">
    <div class="container">
      <h2 class="text-center mb-4">Upcoming Events</h2>
      <ul class="list-group">
        <li class="list-group-item d-flex align-items-center">
          <div class="d-flex align-items-center">
        <div class="event-logo-wrap" aria-hidden="true">
          <img id="eventLogo" src="assets/images/event1.png" alt="Event 1 Poster" class="event-logo" />
        </div>
        <div>
          <div class="fw-bold">Open Heaven Experience - Concert</div>
          <div class="small text-muted">15 Dec 2025 ‚Ä¢ 7:00 PM</div>
          <div class="small text-warning" id="countdown-event1" aria-live="polite">Loading countdown‚Ä¶</div>
        </div>
          </div>

          <div class="ms-auto">
        <a href="#" data-bs-toggle="modal" data-bs-target="#event1Modal" class="h6 mb-0 text-decoration-none">View Poster</a>
          </div>
        </li>

        <!-- Event 1 Poster Modal -->
        <div class="modal fade" id="event1Modal" tabindex="-1" aria-labelledby="event1ModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg"></div>
        <div class="modal-content bg-dark text-white">
          <div class="modal-header border-0">
            <h5 class="modal-title" id="event1ModalLabel">Event 1 ‚Äî Poster</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-0">
            <img src="assets/images/event1.png" alt="Event 1 Poster" class="img-fluid w-100">
          </div>
          <div class="modal-footer border-0">
            <a href="assets/images/event1.png" download class="btn btn-primary">Download Poster</a>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </ul>
    </div>
  </section>
<section class="cta py-5" aria-label="Support CTA">
  <div class="container vintage-container">
    <div class="row justify-content-center align-items-start">
      <div class="col-md-8 text-center text-white">
        <h2 class="mb-2 fw-bold">
          <span aria-hidden="true" class="rotate-emoji">
            üïäÔ∏è
          </span>
          Stand With Arise ‚Äî Pledge Support
        </h2>
        <div class="accent-bar" aria-hidden="true"></div>
        <p class="lead">Join our mission to lift hearts and communities through worship. Pledge a one-time gift or a regular contribution ‚Äî every gift helps us reach more lives.</p>
        <p class="mb-3 cta-subtext">
          Prefer to chat first? Email us at
          <a href="mailto:arisebandkenya@gmail.com" class="text-white text-decoration-underline">arisebandkenya@gmail.com</a>.
        </p>

        <div class="d-flex justify-content-center gap-3 flex-wrap" role="group" aria-label="Donation actions">
          <button class="btn-vintage" data-bs-toggle="modal" data-bs-target="#mpesaModal" aria-controls="mpesaModal">
            üì± Pledge via M-Pesa
          </button>
          <button type="button" class="btn btn-outline-vintage btn-lg d-flex align-items-center gap-2" aria-label="Give online" onclick="location.href='online-payments.html'">
            <span aria-hidden="true">üåê</span>
            <span>Give Online</span>
            <small class="text-muted ms-2 secure-badge">Secure</small>
          </button>
          </a>
          <button class="btn btn-warning btn-lg text-dark" data-bs-toggle="m</span>odal" data-bs-target="#pledgeModal">
            Make a Pledge
          </button>
        </div>

        <p class="mt-3 mb-0 small muted-note">M-Pesa: Payb</svg>ill 123456 (use your name/phone as Account). Replace with your official paybill/till when ready. Online payments processed securely ‚Äî we never store payment credentials.</p>
      </div>

      <div class="col-md-4 col-sm-8 mt-4 mt-md-0">
        <div class="vintage-card">
          <h5 class="card-title mb-3">Quick Pledge</h5>
          <form id="quickPledgeForm" class="row g-2" novalidate>
            <div class="col-12">
              <label for="pledgeAmount" class="form-label visually-hidden">Amount</label>
              <input id="pledgeAmount" name="amount" type="number" min="1" class="form-control" placeholder="Amount (KES)" required>
            </div>
            <div class="col-12">
              <label for="pledgePhone" class="form-label visually-hidden">Phone (for M-Pesa)</label>
              <input id="pledgePhone" name="phone" type="tel" class="form-control" placeholder="Phone (07XXXXXXXX)" required>
            </div>
            <div class="col-12">
              <label for="pledgeNote" class="form-label visually-hidden">Note</label>
              <input id="pledgeNote" name="note" type="text" class="form-control" placeholder="Note (optional)">
            </div>
            <div class="col-12 d-grid">
              <button type="button" class="btn btn-vintage" data-bs-toggle="modal" data-bs-target="#mpesaModal">
                Prepare M-Pesa Payment
              </button>
            </div>
            <div class="col-12 text-center mt-2">
              <small class="text-muted">Or tap "Give Online" for card, mobile money or QR pay.</small>
            </div>
          </form>
        </div>
      </div>

      <!-- M-Pesa Payment Modal -->
      <div class="modal fade" id="mpesaModal" tabindex="-1" aria-labelledby="mpesaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header bg-success text-white">
              <h5 class="modal-title" id="mpesaModalLabel">
                <i class="bi bi-phone-fill me-2"></i>M-Pesa Payment
              </h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div id="mpesaStep1" class="mpesa-step">
                <div class="text-center mb-4">
                  <div class="mpesa-logo-circle">
                    <span class="mpesa-text">M-PESA</span>
                  </div>
                </div>
                
                <h6 class="mb-3">Confirm Payment Details</h6>
                
                <div class="payment-summary p-3 mb-3 bg-light rounded">
                  <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Amount:</span>
                    <strong class="text-success" id="confirmAmount">KES 0</strong>
                  </div>
                  <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Your Phone:</span>
                    <strong id="confirmPhone">-</strong>
                  </div>
                  <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">To M-Pesa:</span>
                    <strong class="text-success">0790190578</strong>
                  </div>
                  <div class="d-flex justify-content-between">
                    <span class="text-muted">Note:</span>
                    <span id="confirmNote" class="text-end">-</span>
                  </div>
                </div>

                <div class="alert alert-info">
                  <i class="bi bi-info-circle me-2"></i>
                  <small>A payment prompt will be sent to your phone. Enter your M-Pesa PIN to complete the transaction.</small>
                </div>
              </div>

              <div id="mpesaStep2" class="mpesa-step">
                <div class="text-center py-4">
                  <div class="spinner-border text-success mb-3" role="status">
                    <span class="visually-hidden">Processing...</span>
                  </div>
                  <h5 class="mb-3">Processing Payment...</h5>
                  <p class="text-muted">Please check your phone for the M-Pesa prompt</p>
                  <div class="phone-animation mb-3">
                    <i class="bi bi-phone-vibrate"></i>
                  </div>
                  <p class="text-success fw-bold">Enter your M-Pesa PIN on your phone</p>
                  <div class="alert alert-warning mt-3">
                    <small><strong>Note:</strong> You will receive an STK Push prompt on <span id="processingPhone"></span></small>
                  </div>
                </div>
              </div>

              <div id="mpesaStep3" class="mpesa-step">
                <div class="text-center py-4">
                  <div class="success-checkmark mb-3">
                    <i class="bi bi-check-circle-fill success-icon"></i>
                  </div>
                  <h5 class="text-success mb-3">Payment Successful!</h5>
                  <p class="text-muted">Thank you for your generous pledge.</p>
                  <div class="receipt-box p-3 mt-3">
                    <p class="mb-2"><strong>Transaction ID:</strong> <span id="transactionId">-</span></p>
                    <p class="mb-2"><strong>Amount:</strong> <span id="receiptAmount">-</span></p>
                    <p class="mb-0"><strong>Phone:</strong> <span id="receiptPhone">-</span></p>
                  </div>
                  <p class="small text-muted mt-3">You will receive an SMS confirmation from M-Pesa shortly.</p>
                </div>
              </div>

              <div id="mpesaStep4" class="mpesa-step">
                <div class="text-center py-4">
                  <div class="error-icon-container mb-3">
                    <i class="bi bi-x-circle-fill error-icon"></i>
                  </div>
                  <h5 class="text-danger mb-3">Payment Failed</h5>
                  <p id="errorMessage">The transaction could not be completed.</p>
                  <div class="alert alert-warning mt-3">
                    <small><strong>Common Issues:</strong></small>
                    <ul class="small text-start mb-0 mt-2">
                      <li>Insufficient M-Pesa balance</li>
                      <li>Wrong PIN entered</li>
                      <li>Request timeout/cancelled</li>
                      <li>Phone number not registered for M-Pesa</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="mpesaCloseBtn">Close</button>
              <button type="button" class="btn btn-success" id="initiatePaymentBtn">
                <i class="bi bi-send-fill me-2"></i>Send Payment Prompt
              </button>
              <button type="button" class="btn btn-primary" id="tryAgainBtn">
                <i class="bi bi-arrow-clockwise me-2"></i>Try Again
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Pledge Confirmation Modal -->
      <div class="modal fade" id="pledgeModal" tabindex="-1" aria-labelledby="pledgeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-body text-center py-4">
              <h5 class="mb-2">Thank you!</h5>
              <p class="small mb-3">We appreciate your heart to support Arise. Follow the steps in the M-Pesa modal or choose Give Online to complete your gift.</p>
              <button type="button" class="btn btn-success" data-bs-dismiss="modal">Got it ‚Äî close</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>
</section>

  <!-- Fan Wall Section -->
  <section id="fanwall" class="py-5 bg-dark" aria-labelledby="fanwallHeading">
    <div class="container">
      <div class="text-center mb-5">
        <h2 id="fanwallHeading" class="display-5 fw-bold text-white mb-3">
          <span class="text-info">üí¨</span> Fan Wall
        </h2>
        <p class="lead text-white-50">Share your love, support, and shoutouts with the Arise Band KE family!</p>
      </div>

      <!-- Add Shoutout Form -->
      <div class="row justify-content-center mb-5">
        <div class="col-lg-8">
          <div class="card bg-gradient shadow-lg border-0">
            <div class="card-body p-4">
              <h5 class="card-title text-center mb-4">
                <i class="bi bi-megaphone-fill text-info"></i> Post Your Shoutout
              </h5>
              <form id="fanWallForm" novalidate>
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="fanName" class="form-label">Your Name</label>
                    <input type="text" class="form-control" id="fanName" placeholder="e.g., John Doe" required maxlength="50">
                    <div class="invalid-feedback">Please enter your name (max 50 characters).</div>
                  </div>
                  <div class="col-md-6">
                    <label for="fanLocation" class="form-label">Location (Optional)</label>
                    <input type="text" class="form-control" id="fanLocation" placeholder="e.g., Nairobi, Kenya" maxlength="50">
                  </div>
                  <div class="col-12">
                    <label for="fanMessage" class="form-label">Your Message</label>
                    <textarea class="form-control" id="fanMessage" rows="4" placeholder="Share your thoughts, support, or favorite song..." required maxlength="500"></textarea>
                    <div class="form-text text-muted">
                      <span id="charCount">0</span>/500 characters
                    </div>
                    <div class="invalid-feedback">Please write a message (max 500 characters).</div>
                  </div>
                  <div class="col-12 text-center">
                    <button type="submit" class="btn btn-info btn-lg px-5">
                      <i class="bi bi-send-fill"></i> Post Shoutout
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Fan Wall Posts -->
      <div class="row">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="text-white mb-0">
              <i class="bi bi-chat-heart-fill text-danger"></i> Recent Shoutouts
            </h4>
            <span class="badge bg-info" id="postCount">0 posts</span>
          </div>
          
          <div id="fanWallPosts" class="row g-4">
            <!-- Posts will be dynamically inserted here -->
            <div class="col-12 text-center py-5">
              <p class="text-white-50">No shoutouts yet. Be the first to share your love! ‚ù§Ô∏è</p>
            </div>
          </div>

          <!-- Load More Button -->
          <div class="text-center mt-4" id="loadMoreContainer" style="display: none;">
            <button class="btn btn-outline-info" id="loadMoreBtn">
              <i class="bi bi-arrow-down-circle"></i> Load More
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section (full-width, catchy colors & styles) -->
  <section id="contact" class="py-5 position-relative overflow-hidden" aria-labelledby="contactHeading">
    <div class="container-fluid px-0">
      <div class="mx-auto px-3 contact-card">
        <div class="row align-items-center g-4">
          <div class="col-lg-6">
            <h2 id="contactHeading" class="display-6 contact-heading mb-2">Reach Out to Arise Band_KE</h2>
            <p class="lead contact-sub mb-4">Worship ‚Ä¢ Collaborate ‚Ä¢ Celebrate ‚Äî tell us how we can serve. We typically respond within 48 hours.</p>

            <ul class="list-unstyled mb-0">
              <li class="mb-2 contact-note"><strong>Email:</strong> <a class="text-decoration-underline contact-email-link" href="mailto:arisebandkenya@gmail.com">arisebandkenya@gmail.com</a></li>
              <li class="mb-2 contact-note"><strong>Phone/WhatsApp:</strong> <span class="contact-info">+254 7XX XXX XXX</span></li>
              <li class="mb-0 contact-note">
                <strong>Booking:</strong>
                <span class="contact-info">
                  <a href="#" class="text-decoration-underline text-info" data-bs-toggle="modal" data-bs-target="#bookingConcerts">Concerts</a>
                   ‚Ä¢
                  <a href="#" class="text-decoration-underline text-info" data-bs-toggle="modal" data-bs-target="#bookingOutreach">Outreach</a>
                   ‚Ä¢
                  <a href="#" class="text-decoration-underline text-info" data-bs-toggle="modal" data-bs-target="#bookingWorship">Worship Nights</a>
                </span>
              </li>

              <!-- Booking Modals (hidden until clicked) -->
              <div class="modal fade" id="bookingConcerts" tabindex="-1" aria-labelledby="bookingConcertsLabel" aria-hidden="true"></span>
            </ul>
          </div>

          <div class="col-lg-6">
            <form id="contactForm" class="row g-3" novalidate>
              <div class="col-md-6">
                <label for="name" class="form-label visually-hidden">Name</label>
                <input id="name" name="name" type="text" class="form-control form-control-lg" placeholder="Your Name" required>
              </div>

              <div class="col-md-6">
                <label for="email" class="form-label visually-hidden">Email</label>
                <input id="email" name="email" type="email" class="form-control form-control-lg" placeholder="Your Email" required>
              </div>

              <div class="col-12">
                <label for="subject" class="form-label visually-hidden">Subject</label>
                <input id="subject" name="subject" type="text" class="form-control form-control-lg" placeholder="Subject (e.g., Booking, Collaboration)" required>
              </div>

              <div class="col-12">
                <label for="message" class="form-label visually-hidden">Message</label>
                <textarea id="message" name="message" rows="5" class="form-control form-control-lg" placeholder="Tell us about your event or how you'd like to connect..." required></textarea>
              </div>

              <div class="col-12 d-flex justify-content-center">
                <button type="submit" class="btn btn-cta">Send Message ‚Üí</button>
              </div>

              <div class="col-12 text-center mt-2">
                <small class="contact-note">Or email us directly: <a href="mailto:arisebandkenya@gmail.com" class="contact-email-link">arisebandkenya@gmail.com</a></small>
              </div>

              <div id="contactFeedback" class="col-12 text-center mt-2 hidden" aria-live="polite">
                <small class="fw-bold feedback-text">Thanks ‚Äî your message was sent.</small>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Event Notification Popup -->
  <div class="event-popup" id="eventPopup">
    <div class="event-popup-content">
      <button class="event-popup-close" id="closePopup">&times;</button>
      <div class="event-popup-header">
        <img src="assets/images/event1.png" alt="Open Heaven Experience" class="event-popup-img">
      </div>
      <div class="event-popup-body">
        <h4 class="mb-3">üéâ Upcoming Event!</h4>
        <h5 class="event-title">Open Heaven Experience</h5>
        <p class="event-location">üìç Busia Stadium</p>
        <p class="event-date">üìÖ December 15, 2025</p>
        <div class="countdown-timer mt-3">
          <div class="countdown-item">
            <span class="countdown-value" id="days">00</span>
            <span class="countdown-label">Days</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="hours">00</span>
            <span class="countdown-label">Hours</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="minutes">00</span>
            <span class="countdown-label">Minutes</span>
          </div>
          <div class="countdown-item">
            <span class="countdown-value" id="seconds">00</span>
            <span class="countdown-label">Seconds</span>
          </div>
        </div>
        <button id="learnMoreBtn" class="btn btn-primary mt-3 w-100">Learn More</button>
      </div>
    </div>
  </div>

  <!-- Attendance Confirmation Modal -->
  <div class="attendance-modal" id="attendanceModal">
    <div class="attendance-modal-content">
      <button class="attendance-modal-close" id="closeAttendanceModal">&times;</button>
      <div class="attendance-modal-body">
        <div class="attendance-icon">‚úì</div>
        <h3 class="mb-3">Confirm Your Attendance</h3>
        <p class="mb-3">Will you be joining us at the Open Heaven Experience?</p>
        
        <div class="event-details-summary mb-4">
          <p><strong>Event:</strong> Open Heaven Experience</p>
          <p><strong>Date:</strong> December 15, 2025 at 6:00 PM</p>
          <p><strong>Location:</strong> Busia Stadium</p>
        </div>
        
        <form id="attendanceForm" class="attendance-form">
          <div class="mb-3">
            <input type="text" id="attendeeName" class="form-control" placeholder="Your Full Name" required>
          </div>
          <div class="mb-3">
            <input type="email" id="attendeeEmail" class="form-control" placeholder="Your Email" required>
          </div>
          <div class="mb-3">
            <input type="tel" id="attendeePhone" class="form-control" placeholder="Your Phone Number (Optional)">
          </div>
        </form>
        
        <div class="attendance-actions">
          <button id="confirmAttendanceBtn" class="btn btn-success w-100 mb-2">
            <span>‚úì</span> Yes, I'll Attend
          </button>
          <button id="addToCalendarBtn" class="btn btn-outline-light w-100 mb-3">
            <span>üìÖ</span> Add to Calendar
          </button>
          <button id="continueAnywayBtn" class="btn btn-link text-white">
            Continue to Event Page
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white text-center py-3">
    <p class="mb-0">&copy; 2025 Arise Band_KE. All rights reserved.</p>
    <div>
      <a href="https://instagram.com" class="text-white me-2"><i class="fab fa-instagram"></i></a>
      <a href="https://youtube.com" class="text-white me-2"><i class="fab fa-youtube"></i></a>
      <a href="https://facebook.com" class="text-white me-2"><i class="fab fa-facebook"></i></a>
      <a href="https://tiktok.com" class="text-white"><i class="fab fa-tiktok"></i></a>
    </div>
  </footer>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Custom JavaScript -->
  <script src="scripts/main.js"></script>
  
  <!-- M-Pesa Payment Script -->
  <script>
    // M-Pesa Configuration
    const MPESA_API_URL = 'YOUR_MPESA_API_ENDPOINT'; // Replace with your backend API endpoint
    const MPESA_BUSINESS_SHORTCODE = '174379'; // Replace with your actual paybill/till number
    const MPESA_RECEIVING_NUMBER = '254790190578'; // Arise Band KE M-Pesa number
    
    // Store payment details
    let paymentDetails = {
      amount: 0,
      phone: '',
      note: ''
    };
    
    // Handle "Prepare M-Pesa Payment" button click
    document.getElementById('quickPledgeForm').addEventListener('submit', function(e) {
      e.preventDefault();
    });
    
    // When modal is shown, populate confirmation details
    document.getElementById('mpesaModal').addEventListener('show.bs.modal', function () {
      const amount = document.getElementById('pledgeAmount').value;
      const phone = document.getElementById('pledgePhone').value;
      const note = document.getElementById('pledgeNote').value;
      
      // Validate inputs
      if (!amount || amount <= 0) {
        alert('Please enter a valid amount');
        return false;
      }
      
      if (!phone || phone.length < 10) {
        alert('Please enter a valid phone number');
        return false;
      }
      
      // Store payment details
      paymentDetails = {
        amount: amount,
        phone: phone,
        note: note || 'Pledge to Arise Band KE'
      };
      
      // Format phone number (remove spaces, ensure 254 format)
      let formattedPhone = phone.replace(/\s+/g, '');
      if (formattedPhone.startsWith('0')) {
        formattedPhone = '254' + formattedPhone.substring(1);
      } else if (formattedPhone.startsWith('+')) {
        formattedPhone = formattedPhone.substring(1);
      } else if (!formattedPhone.startsWith('254')) {
        formattedPhone = '254' + formattedPhone;
      }
      
      paymentDetails.phone = formattedPhone;
      
      // Update confirmation display
      document.getElementById('confirmAmount').textContent = 'KES ' + amount;
      document.getElementById('confirmPhone').textContent = phone;
      document.getElementById('confirmNote').textContent = note || '-';
      
      // Reset to step 1
      showMpesaStep(1);
    });
    
    // Handle "Send Payment Prompt" button
    document.getElementById('initiatePaymentBtn').addEventListener('click', function() {
      initiateSTKPush();
    });
    
    // Handle "Try Again" button
    document.getElementById('tryAgainBtn').addEventListener('click', function() {
      showMpesaStep(1);
    });
    
    // Show specific M-Pesa step
    function showMpesaStep(step) {
      // Hide all steps
      document.querySelectorAll('.mpesa-step').forEach(el => el.style.display = 'none');
      
      // Show selected step
      document.getElementById('mpesaStep' + step).style.display = 'block';
      
      // Manage buttons
      const initiateBtn = document.getElementById('initiatePaymentBtn');
      const tryAgainBtn = document.getElementById('tryAgainBtn');
      const closeBtn = document.getElementById('mpesaCloseBtn');
      
      initiateBtn.style.display = step === 1 ? 'inline-block' : 'none';
      tryAgainBtn.style.display = step === 4 ? 'inline-block' : 'none';
      closeBtn.textContent = (step === 3 || step === 4) ? 'Close' : 'Cancel';
    }
    
    // Initiate STK Push
    async function initiateSTKPush() {
      console.log('Initiating M-Pesa STK Push...');
      console.log('Payment Details:', paymentDetails);
      
      // Show processing step
      showMpesaStep(2);
      document.getElementById('processingPhone').textContent = paymentDetails.phone;
      
      try {
        // Simulate API call (replace with actual M-Pesa Daraja API call)
        const response = await sendMpesaRequest(paymentDetails);
        
        if (response.success) {
          // Show success step
          setTimeout(() => {
            showMpesaStep(3);
            document.getElementById('transactionId').textContent = response.transactionId || 'MPESA-' + Date.now();
            document.getElementById('receiptAmount').textContent = 'KES ' + paymentDetails.amount;
            document.getElementById('receiptPhone').textContent = paymentDetails.phone;
            
            // Clear form
            document.getElementById('quickPledgeForm').reset();
            
            // Send notification to band
            sendPledgeNotification(paymentDetails, response.transactionId);
          }, 3000); // Simulate 3 second processing
        } else {
          // Show error step
          setTimeout(() => {
            showMpesaStep(4);
            document.getElementById('errorMessage').textContent = response.message || 'The transaction could not be completed.';
          }, 2000);
        }
      } catch (error) {
        console.error('M-Pesa error:', error);
        setTimeout(() => {
          showMpesaStep(4);
          document.getElementById('errorMessage').textContent = 'Network error. Please check your connection and try again.';
        }, 2000);
      }
    }
    
    // Send M-Pesa request (this would call your backend API)
    async function sendMpesaRequest(details) {
      // FOR TESTING: Simulate successful payment
      // In production, this should call your backend API which integrates with M-Pesa Daraja API
      
      console.log('Sending M-Pesa request to backend...');
      
      // Simulate API call
      return new Promise((resolve) => {
        setTimeout(() => {
          // Simulate random success/failure for testing
          const isSuccess = Math.random() > 0.2; // 80% success rate for demo
          
          if (isSuccess) {
            resolve({
              success: true,
              transactionId: 'PLD' + Date.now(),
              message: 'Payment completed successfully'
            });
          } else {
            resolve({
              success: false,
              message: 'Transaction was cancelled or timed out'
            });
          }
        }, 1000);
      });
      
      /* 
      // PRODUCTION CODE: Call your backend API
      try {
        const response = await fetch(MPESA_API_URL + '/stkpush', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            phone: details.phone,
            amount: details.amount,
            accountReference: 'PLEDGE',
            transactionDesc: details.note
          })
        });
        
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('API Error:', error);
        throw error;
      }
      */
    }
    
    // Send pledge notification to band
    async function sendPledgeNotification(details, transactionId) {
      // Use EmailJS to notify the band
      try {
        if (typeof emailjs !== 'undefined') {
          await emailjs.send(
            'service_jhdkc2a',
            'template_fewu93i',
            {
              from_name: 'M-Pesa Pledge',
              from_email: 'pledges@ariseband.com',
              phone: details.phone,
              event_name: 'Pledge Received',
              event_date: new Date().toLocaleString(),
              event_location: 'Online',
              timestamp: new Date().toLocaleString(),
              message: `Pledge Amount: KES ${details.amount}\nFrom Phone: ${details.phone}\nTo M-Pesa: 0790190578\nTransaction ID: ${transactionId}\nNote: ${details.note}`
            }
          );
          console.log('Pledge notification sent to band');
        }
      } catch (error) {
        console.error('Error sending pledge notification:', error);
      }
    }
  </script>
  
  <!-- Fan Wall Script -->
  <script>
    // Fan Wall Configuration
    const FAN_WALL_STORAGE_KEY = 'ariseBandFanWall';
    const POSTS_PER_PAGE = 6;
    let currentPage = 1;
    let allPosts = [];

    // Load posts from localStorage
    function loadPosts() {
      const stored = localStorage.getItem(FAN_WALL_STORAGE_KEY);
      allPosts = stored ? JSON.parse(stored) : [];
      return allPosts;
    }

    // Save posts to localStorage
    function savePosts() {
      localStorage.setItem(FAN_WALL_STORAGE_KEY, JSON.stringify(allPosts));
    }

    // Create post HTML
    function createPostHTML(post) {
      const timeAgo = getTimeAgo(post.timestamp);
      const locationHTML = post.location ? `<small class="text-info"><i class="bi bi-geo-alt-fill"></i> ${escapeHtml(post.location)}</small>` : '';
      
      return `
        <div class="col-md-6 col-lg-4 fade-in">
          <div class="card h-100 shadow-sm border-info" style="border-left: 4px solid #0dcaf0;">
            <div class="card-body">
              <div class="d-flex align-items-start mb-3">
                <div class="avatar-circle me-3">
                  ${post.name.charAt(0).toUpperCase()}
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-0 text-white">${escapeHtml(post.name)}</h6>
                  ${locationHTML}
                </div>
              </div>
              <p class="card-text text-white-50 mb-2">${escapeHtml(post.message)}</p>
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                  <i class="bi bi-clock"></i> ${timeAgo}
                </small>
                <button class="btn btn-sm btn-outline-danger delete-post" data-post-id="${post.id}">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Display posts
    function displayPosts() {
      const container = document.getElementById('fanWallPosts');
      const postsToShow = allPosts.slice(0, currentPage * POSTS_PER_PAGE);
      
      if (allPosts.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center py-5">
            <p class="text-white-50">No shoutouts yet. Be the first to share your love! ‚ù§Ô∏è</p>
          </div>
        `;
        document.getElementById('loadMoreContainer').style.display = 'none';
        document.getElementById('postCount').textContent = '0 posts';
        return;
      }

      container.innerHTML = postsToShow.map(post => createPostHTML(post)).join('');
      
      // Update post count
      document.getElementById('postCount').textContent = `${allPosts.length} post${allPosts.length !== 1 ? 's' : ''}`;
      
      // Show/hide load more button
      const loadMoreContainer = document.getElementById('loadMoreContainer');
      if (postsToShow.length < allPosts.length) {
        loadMoreContainer.style.display = 'block';
      } else {
        loadMoreContainer.style.display = 'none';
      }

      // Add delete event listeners
      document.querySelectorAll('.delete-post').forEach(btn => {
        btn.addEventListener('click', function() {
          const postId = this.getAttribute('data-post-id');
          deletePost(postId);
        });
      });
    }

    // Delete post
    function deletePost(postId) {
      if (confirm('Are you sure you want to delete this shoutout?')) {
        allPosts = allPosts.filter(post => post.id !== postId);
        savePosts();
        displayPosts();
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Get time ago string
    function getTimeAgo(timestamp) {
      const now = Date.now();
      const diff = now - timestamp;
      
      const seconds = Math.floor(diff / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);
      
      if (days > 30) return new Date(timestamp).toLocaleDateString();
      if (days > 0) return `${days}d ago`;
      if (hours > 0) return `${hours}h ago`;
      if (minutes > 0) return `${minutes}m ago`;
      return 'Just now';
    }

    // Form submission
    document.getElementById('fanWallForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const form = this;
      if (!form.checkValidity()) {
        e.stopPropagation();
        form.classList.add('was-validated');
        return;
      }

      const name = document.getElementById('fanName').value.trim();
      const location = document.getElementById('fanLocation').value.trim();
      const message = document.getElementById('fanMessage').value.trim();

      if (!name || !message) {
        alert('Please fill in all required fields');
        return;
      }

      // Create new post
      const newPost = {
        id: 'post_' + Date.now(),
        name: name,
        location: location,
        message: message,
        timestamp: Date.now()
      };

      // Add to beginning of array (newest first)
      allPosts.unshift(newPost);
      savePosts();

      // Reset form
      form.reset();
      form.classList.remove('was-validated');
      document.getElementById('charCount').textContent = '0';

      // Refresh display
      currentPage = 1;
      displayPosts();

      // Scroll to posts
      document.getElementById('fanWallPosts').scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Show success message
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="bi bi-check-circle-fill"></i> Posted!';
      submitBtn.classList.add('btn-success');
      submitBtn.classList.remove('btn-info');
      
      setTimeout(() => {
        submitBtn.innerHTML = originalHTML;
        submitBtn.classList.remove('btn-success');
        submitBtn.classList.add('btn-info');
      }, 2000);
    });

    // Character counter
    document.getElementById('fanMessage').addEventListener('input', function() {
      const count = this.value.length;
      document.getElementById('charCount').textContent = count;
    });

    // Load more button
    document.getElementById('loadMoreBtn').addEventListener('click', function() {
      currentPage++;
      displayPosts();
    });

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadPosts();
      displayPosts();
    });
  </script>
  
  <!-- Event Popup Script -->
  <script>
    // Wait for EmailJS to be loaded
    window.addEventListener('load', function() {
      if (typeof emailjs !== 'undefined') {
        console.log('‚úÖ EmailJS library loaded successfully');
      } else {
        console.error('‚ùå EmailJS library failed to load');
      }
    });
    
    // Event date: December 15, 2025
    const eventDate = new Date('December 15, 2025 18:00:00').getTime();
    
    // Countdown Timer Function
    function updateCountdown() {
      const now = new Date().getTime();
      const distance = eventDate - now;
      
      if (distance > 0) {
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
        document.getElementById('days').textContent = String(days).padStart(2, '0');
        document.getElementById('hours').textContent = String(hours).padStart(2, '0');
        document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
        document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
      } else {
        document.getElementById('days').textContent = '00';
        document.getElementById('hours').textContent = '00';
        document.getElementById('minutes').textContent = '00';
        document.getElementById('seconds').textContent = '00';
      }
    }
    
    // Show popup function
    function showEventPopup() {
      const popup = document.getElementById('eventPopup');
      popup.classList.add('show');
    }
    
    // Close popup function
    function closeEventPopup() {
      const popup = document.getElementById('eventPopup');
      popup.classList.remove('show');
    }
    
    // Close button event
    document.getElementById('closePopup').addEventListener('click', closeEventPopup);
    
    // Close on outside click
    document.getElementById('eventPopup').addEventListener('click', function(e) {
      if (e.target === this) {
        closeEventPopup();
      }
    });
    
    // Update countdown every second
    setInterval(updateCountdown, 1000);
    
    // Show popup every 45 seconds
    setInterval(showEventPopup, 45000);
    
    // Show popup on page load after 5 seconds
    setTimeout(showEventPopup, 5000);
    
    // Initialize countdown
    updateCountdown();
    
    // Attendance Modal Functions
    const attendanceModal = document.getElementById('attendanceModal');
    const learnMoreBtn = document.getElementById('learnMoreBtn');
    const closeAttendanceModal = document.getElementById('closeAttendanceModal');
    const confirmAttendanceBtn = document.getElementById('confirmAttendanceBtn');
    const addToCalendarBtn = document.getElementById('addToCalendarBtn');
    const continueAnywayBtn = document.getElementById('continueAnywayBtn');
    
    // Show attendance modal
    function showAttendanceModal() {
      closeEventPopup();
      attendanceModal.classList.add('show');
    }
    
    // Close attendance modal
    function closeAttendanceModalFunc() {
      attendanceModal.classList.remove('show');
    }
    
    // Navigate to event page
    function goToEventPage() {
      window.location.href = 'pages/Event1.html';
    }
    
    // Add to calendar function (creates .ics file)
    function addToCalendar() {
      const event = {
        title: 'Open Heaven Experience',
        description: 'Join Arise Band KE for a powerful night of worship and unity at the Open Heaven Experience.',
        location: 'Busia Stadium',
        start: '20251215T180000',
        end: '20251215T220000'
      };
      
      const icsContent = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'BEGIN:VEVENT',
        'DTSTART:' + event.start,
        'DTEND:' + event.end,
        'SUMMARY:' + event.title,
        'DESCRIPTION:' + event.description,
        'LOCATION:' + event.location,
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\n');
      
      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'open-heaven-experience.ics';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      // Show confirmation message
      alert('Event added to calendar! Check your downloads folder.');
    }
    
    // Google Sheets Web App URL (Replace with your deployed Google Apps Script URL)
    const GOOGLE_SHEETS_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
    
    // Band email configuration
    const BAND_EMAIL = 'arisebandke@gmail.com';
    
    // Function to send data to Google Sheets
    async function sendToGoogleSheets(data) {
      try {
        const response = await fetch(GOOGLE_SHEETS_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
        return true;
      } catch (error) {
        console.error('Error sending to Google Sheets:', error);
        return false;
      }
    }
    
    // Initialize EmailJS with your Public Key
    (function() {
      try {
        if (typeof emailjs === 'undefined') {
          console.error('‚ùå EmailJS is not loaded! Check internet connection.');
          return;
        }
        emailjs.init({
          publicKey: 'OisfebWWM4Lt4q3QC',
        });
        console.log('‚úÖ EmailJS initialized with public key');
      } catch (error) {
        console.error('‚ùå EmailJS initialization failed:', error);
      }
    })();
    
    // Function to send email notification via EmailJS
    async function sendEmailNotification(name, email, phone) {
      console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
      console.log('üöÄ sendEmailNotification called');
      console.log('Parameters:', { name, email, phone });
      
      try {
        // Check if EmailJS is available
        if (typeof emailjs === 'undefined') {
          throw new Error('EmailJS is not loaded');
        }
        
        console.log('üìß Preparing email...');
        
        const templateParams = {
          from_name: name,
          from_email: email,
          phone: phone || 'Not provided',
          event_name: 'Open Heaven Experience',
          event_date: 'December 15, 2025 at 6:00 PM',
          event_location: 'Busia Stadium',
          timestamp: new Date().toLocaleString(),
          message: `New attendance confirmation from ${name} (${email}). Phone: ${phone || 'Not provided'}`
        };
        
        console.log('üì¶ Template params:', JSON.stringify(templateParams, null, 2));
        console.log('üì§ Sending via service_jhdkc2a, template_fewu93i');
        console.log('‚è≥ Please wait...');
        
        // Send email using EmailJS
        const response = await emailjs.send(
          'service_jhdkc2a',
          'template_fewu93i',
          templateParams
        );
        
        console.log('‚úÖ SUCCESS! Email sent!');
        console.log('Response:', response);
        console.log('Status:', response.status);
        console.log('Text:', response.text);
        console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
        return true;
      } catch (error) {
        console.error('‚ùå ERROR sending email!');
        console.error('Error object:', error);
        console.error('Error message:', error.message);
        console.error('Error text:', error.text);
        console.error('Error status:', error.status);
        
        // Log common issues
        if (error.text && error.text.includes('Invalid')) {
          console.error('üí° TIP: Service ID or Template ID might be incorrect');
          console.error('üí° Check: https://dashboard.emailjs.com/admin');
        }
        if (error.status === 400) {
          console.error('üí° TIP: Template parameters might not match template variables');
        }
        if (error.status === 403 || error.status === 401) {
          console.error('üí° TIP: Public key might be incorrect or service not authorized');
        }
        
        console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
        return false;
      }
    }
    
    // Function to validate and submit attendance
    async function submitAttendance() {
      const name = document.getElementById('attendeeName').value.trim();
      const email = document.getElementById('attendeeEmail').value.trim();
      const phone = document.getElementById('attendeePhone').value.trim();
      
      // Validation
      if (!name || !email) {
        alert('Please fill in your name and email address.');
        return;
      }
      
      // Email validation
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert('Please enter a valid email address.');
        return;
      }
      
      // Prepare data
      const attendanceData = {
        timestamp: new Date().toISOString(),
        name: name,
        email: email,
        phone: phone,
        event: 'Open Heaven Experience',
        eventDate: 'December 15, 2025',
        location: 'Busia Stadium'
      };
      
      // Show loading state
      confirmAttendanceBtn.disabled = true;
      confirmAttendanceBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Submitting...';
      
      try {
        // Send email notification to band
        const emailSent = await sendEmailNotification(name, email, phone);
        
        // Send to Google Sheets (optional - for record keeping)
        await sendToGoogleSheets(attendanceData);
        
        // Store locally
        localStorage.setItem('eventAttendance', JSON.stringify(attendanceData));
        
        // Reset button
        confirmAttendanceBtn.disabled = false;
        confirmAttendanceBtn.innerHTML = '<span>‚úì</span> Yes, I\'ll Attend';
        
        if (emailSent) {
          // Show success message
          alert(`Thank you ${name}! Your attendance has been confirmed and the band has been notified. We look forward to seeing you at the event!`);
        } else {
          // Show partial success message
          alert(`Thank you ${name}! Your attendance has been recorded. We look forward to seeing you at the event!`);
        }
        
        // Navigate to event page
        goToEventPage();
      } catch (error) {
        // Reset button on error
        confirmAttendanceBtn.disabled = false;
        confirmAttendanceBtn.innerHTML = '<span>‚úì</span> Yes, I\'ll Attend';
        
        // Show error but still allow navigation
        alert(`Thank you for your interest! Your attendance has been noted. You can still view the event details!`);
        
        // Store locally even if online submission fails
        localStorage.setItem('eventAttendance', JSON.stringify(attendanceData));
        
        // Navigate to event page
        goToEventPage();
      }
    }
    
    // Event Listeners
    learnMoreBtn.addEventListener('click', showAttendanceModal);
    closeAttendanceModal.addEventListener('click', closeAttendanceModalFunc);
    
    confirmAttendanceBtn.addEventListener('click', submitAttendance);
    
    addToCalendarBtn.addEventListener('click', addToCalendar);
    continueAnywayBtn.addEventListener('click', goToEventPage);
    
    // Handle form submission with Enter key
    document.getElementById('attendanceForm').addEventListener('submit', function(e) {
      e.preventDefault();
      submitAttendance();
    });
    
    // Close modal on outside click
    attendanceModal.addEventListener('click', function(e) {
      if (e.target === this) {
        closeAttendanceModalFunc();
      }
    });
  </script>
</body>

</html>